{"changed":false,"filter":false,"title":"testing_scripts.py","tooltip":"/kaggle_scripts/testing_scripts.py","value":"#Training set has 61878 rows and 95 columns\n\nimport csv\nimport numpy as np\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import log_loss\nfrom sklearn.cross_validation import KFold\n\nx=[]\ny=[]\nwith open(\"../input/train.csv\",'r') as f:\n    r=csv.reader(f)\n    header=next(r)\n    #print(header)\n    for row in r:\n        x.append([float(e) for e in row[1:-1]])\n        y.append(float(row[-1][-1]))\ns=StandardScaler()\nx=s.fit_transform(x)\ny=np.array(y)\n\nnrow=len(y)\nnlab=9\n\ndef docv(clf,x,y,kf):\n    pred=np.zeros((nrow,nlab))\n    for trainidx,testidx in kf:\n        clf.fit(x[trainidx],y[trainidx])\n        pred[testidx]=clf.predict_proba(x[testidx])\n    return pred\n\nkf=KFold(nrow,5,shuffle=True,random_state=0)\nfor clf,clfname in (\n#        [LogisticRegression(C=10),'logreg10'],\n#        [LogisticRegression(C=50),'logreg50'],\n#        [LogisticRegression(C=100),'logreg100'],\n#        [RandomForestClassifier(n_estimators=10),'rf10'],\n#        [RandomForestClassifier(n_estimators=20),'rf20'],\n#        [RandomForestClassifier(n_estimators=50),'rf50'],\n#        [RandomForestClassifier(n_estimators=100),'rf100'],\n#        [RandomForestClassifier(n_estimators=200),'rf200'],\n        ):\n    print('%s %.3f'%(clfname,log_loss(y,docv(clf,x,y,kf))))","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":44,"column":59},"end":{"row":44,"column":59},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1447412237967}